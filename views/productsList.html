{% extends 'layout.html' %}

{% block content %}
<script>
    $(document).ready(() => {
        paging();
    })
    async function paging() {
        const id = `{{type}}`;
        var totalData;
        await axios.get(`/productList/${id}/json`)
            .then((data) => {
                totalData = data.data.length; // 총 데이터 수

            })
        var currentPage = 1;
        var dataPerPage = 3;    // 한 페이지에 나타낼 데이터 수
        var pageCount = Math.ceil(totalData / dataPerPage);      // 한 화면에 나타낼 페이지 수

        var totalPage;    // 총 페이지 수
        var pageGroup = Math.ceil(currentPage / pageCount);    // 페이지 그룹
        // alert("pageGroup : " + pageGroup);

        var last = pageGroup * pageCount;    // 화면에 보여질 마지막 페이지 번호
        if (last > totalPage)
            last = totalPage;
        var first = last - (pageCount - 1);    // 화면에 보여질 첫번째 페이지 번호
        var next = last + 1;
        var prev = first - 1;

        console.log("last : " + last);
        console.log("first : " + first);
        console.log("next : " + next);
        console.log("prev : " + prev);

        var html = '';

        if (prev > 0)
            html += "<a href=# id='prev'><</a> ";

        for (var i = first; i <= last; i++) {
            html += ` <li class="page-item"><a class='page-link' href='#'>${i}</a></li>`

        }

        console.log(html);
        if (last < totalPage)
            html += "<a href=# id='next'>></a>";

        $("#cur_page").after(html);    // 페이지 목록 생성
        // $("#paging a").css("color", "black");
        // $("#paging a#" + currentPage).css({"text-decoration":"none", 
        //                                    "color":"red", 
        //                                    "font-weight":"bold"});    // 현재 페이지 표시

    }
</script>

<body>
    <!-- Page Content -->
    <div class="container">
        </br>
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a href="/">Main</a>
            </li>
            <li class="breadcrumb-item active">{{type}}</li>
        </ol>
        <div class="row">
            {% for item in result %}
            <div class="col-lg-3 col-md-4 col-sm-6 portfolio-item">
                <div class="card h-100">
                    <a href="#"><img class="card-img-top" src={{item.proPhoto}} alt="" height="250" width="300"></a>
                    <div class="card-body">
                        <h4 class="card-title">
                            <a href="/product/{{item.id}}">{{item.proName}}</a>
                        </h4>
                        <p class="card-text">{{item.proContent}}</p>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>


        <!-- Pagination -->
        <ul class="pagination justify-content-center">
            <li class="page-item">
                <a class="page-link" href="#" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                    <span class="sr-only">Previous</span>
                </a>
            </li>

            <div id="cur_page"></div>

            <li class="page-item">
                <a class="page-link" href="#" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                    <span class="sr-only">Next</span>
                </a>
            </li>
        </ul>


        <div id="paging"></div>
    </div>
    <!-- /.container -->



</body>
{% endblock %}